<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<center>
	<p>run time</p><div id="run_time" style="width:800px;height:250px;"></div>
	<p>scan sites</p><div id="scan_sites" style="width:800px;height:250px;"></div>
	<p>scan pages</p><div id="scan_pages" style="width:800px;height:250px;"></div>
	<p>index sites</p><div id="index_sites" style="width:800px;height:250px;"></div>
	<p>index words</p><div id="index_words" style="width:800px;height:250px;"></div>
	<p>index items</p><div id="index_items" style="width:800px;height:250px;"></div>
	<p>index links</p><div id="index_links" style="width:800px;height:250px;"></div>
	<p>growth items</p><div id="growth_items" style="width:800px;height:250px;"></div>
	<p>growth links</p><div id="growth_links" style="width:800px;height:250px;"></div>

<script>

	function display (text) {
		var lines = text.trim().split(/\n/)
		var data = lines.map(function (line) {return JSON.parse(line)})

		function x() {return data.map(function (d) {return new Date(d.date*1000)})}
		function plot(e,f) { Plotly.plot( e, [{ x:x(), y:data.map(f) }], {margin: { t: 0 } } )}

		plot(run_time, function (d) {return d.date%(60*60)/60.0})
		plot(scan_sites, function (d) {return d.scan.sites})
		plot(scan_pages, function (d) {return d.scan.pages})
		plot(index_sites, function (d) {return d.index.sites})
		plot(index_words, function (d) {return d.index.words})
		plot(index_items, function (d) {return d.index.items})
		plot(index_links, function (d) {return d.index.links})
		plot(growth_items, function (d,i,a) {return i ? d.index.items - a[i-1].index.items : 0})
		plot(growth_links, function (d,i,a) {return i ? d.index.links - a[i-1].index.links : 0})
	}

	Plotly.d3.text('counts.txt', display)

</script>

<footer>
	Sitemap Scrape Statistics<br>
	<a href=http://ward.asia.wiki.org/sitemap-scrape-statistics.html>wiki</a> |
	<a href=https://plot.ly/api/>plotly</a>
